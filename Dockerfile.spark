FROM bitnami/spark:3.5.0

USER root

# Install Python dependencies for PySpark jobs
RUN pip install --no-cache-dir \
    pandas==2.1.4 \
    numpy==1.26.2 \
    psycopg2-binary==2.9.9 \
    sqlalchemy==2.0.23 \
    nltk==3.8.1 \
    scikit-learn==1.3.2

# Download NLTK data
RUN python -c "import nltk; nltk.download('punkt'); nltk.download('stopwords'); nltk.download('wordnet')"

WORKDIR /opt/spark-jobs

USER 1001
